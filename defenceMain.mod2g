use UTbot as knowledge.
use Action as actionspec.
use PickupArmor as module.
use PickupHealth as module.
use PickupOther as module.
use PickupWeapon as module.
use deliverFlag as module.


module defenceMain {

	% Pick up health on our way.
	if bel(status(Health, _), Health < 90, (pickup(UnrealID, 'health', _), item(_, _, _, UnrealID)), not(navigation('noPath', _)), not(navigation('stuck', _))) then PickupHealth.
		
	% Pick up weapons on our way.
	if bel(pickup(ID, 'weapon', _), item(_, 'weapon', NewWeapon, ID), currentWeapon(CurrentWeapon, _), betterWeapon(NewWeapon, CurrentWeapon), not(weapon(NewWeapon, _, _)), not(navigation('noPath', _)), not(navigation('stuck', _))) then PickupWeapon.
		
	% Let the bot go to a module to pick up armor if needed.
	if bel(status(_, Armor), Armor < 80, item(_, 'armor', _, _)) then PickupArmor.
		
	% Pick up other items.
	if bel(item(_, _, _, ID), pickup(ID, 'other', O), not(O=invisibility), not(O=jump_boots), not(O=berserk), not(navigation('noPath', _)), not(navigation('stuck', _))) then PickupOther.
	
	% If the defence bot has a goal to go a specific location the priority is checked and then the bot will handle this goal.
	if goal(goLocationFlag(Position)) then drop(goLocationFlag(Position)) + navigate(Position).		
	if goal(goHomeWithFlag(Position)) then drop(goHomeWithFlag(Position)) + navigate(Position).		
	if goal(goLocationHelp(Position)) then drop(goLocationHelp(Position)) + navigate(Position).	
	if goal(goLocationFlagEnemy(Position)) then drop(goLocationFlagEnemy(Position)) + navigate(Position).	
	if goal(goRandom(Position)) then drop(goRandom(Position)) + navigate(Position).	
	if goal(goLocationKill(Position)) then drop(goLocationKill(Position)) + navigate(Position).	
	if goal(goLocation(Position)) then drop(goLocation(Position)) + navigate(Position).
}