use UTbot as knowledge.
use Action as actionspec.

order = linearall.

module attackEvents {
	
	
	
	
	
	
	
	if a-goal(attack), bel(not(holdingFlag))then adopt(holdingFlag).
	
	if bel(holdingFlag) then (god).send(holdingFlag).
	

	%If we are holding the flag , send to other bots our location. thus 
	
	
	

	% if the Red flag is at home , the adopt the goal to go there.
	if not(a-goal(escort)), bel(enemyBaseLocation(Location), flagState(Team, 'home'), self(_,_, Team2), Team \= Team2) then adopt(at(Location)).
	
	% if flag of opponent is already held then drop the goal to be at the flag base.
	forall a-goal(at(ID)) , bel(enemyBaseLocation(ID), flagState(Team2 , held), self(Player, _, Team), Team \=Team2, not(flag(Team2,Player,_)) ) do drop(at(ID)) +adopt(escort).
	
	%If we are not the escort , but the flag is taken , adopt the escort goal.
	if not(a-goal(escort)) ,bel(flagState(Team2 , held), flagState(Team , home),flag(Team2,ID,_) ,self(ID2,_,Team),ID\=ID2, Team\=Team2) then adopt(escort).

	%if we see the flag , go there.
	if bel(not(enemyBaseLocation(POSBase)), flag(Team,none,POS), self(_,_,Team2), Team\=Team2 , POS\=POSBase) then adopt(at(POS)).
	
	
	% If we have the flag , go back to base.
	if bel(ourBaseLocation(Home), holdingFlag) then adopt(at(Home)).
	
	%if we  have the location of a flag from a  teammate go to there.
	if a-goal(escort), bel (lastKnownLocFlag(Pos)) then adopt (at(Pos)).
	
	%if we have succesfully delivered the flag , or when they recapture it. Drop the escort goal.
	if a-goal(escort),bel(flagState(Team,home),self(_,_,Team2), Team \= Team2) then drop(escort).
	
	%if a-goal(escort), bel(flag(Team , HolderID, Pos),bot(HolderID,_,Team2, Pos,_,_), self(_,_,Team2), Team \= Team2)then adopt(at(Pos)).

	%if we are a escort and we see the enemy flag , go pick it up (Happens when the flag carrier dies)
	if a-goal(escort), bel(flag(Team , none, Pos), self(_,_,Team2), Team \= Team2)then adopt(at(Pos))+drop(escort).
	
	%if we were escorting a person , and our flag was taken , the escort should go in killmodus.
	if a-goal(escort), bel(flagState(Team2,held),flagState(Team,held),self(_,_,Team), Team\=Team2) then adopt(killModus)+drop(escort).
	%drop killModus if our flag is home.
	if a-goal(killModus), bel(flagState(Team, home), self(_,_,Team)) then drop(killModus).		
	
	% if you are not holding the flag anymore than drop the goal to be at our base.
	if a-goal(at(ID)), bel(ourBaseLocation(ID), not(holdingFlag)) then drop(at(ID)).
	 	
	

	if bel(lastKnownLocFlag(POS),(flagState(Team, 'home');flagState(Team, 'held')), self(_,_,Team2), Team\=Team2) then delete(lastKnownLocFlag(POS)).
	
	% if you have been fragged then delete all (at +  fraggedBot) goals.
	forall a-goal(fraggedBot(A,location(X,Y,Z))), bel(self(Victim,_,_), fragged(_,_,Victim,_)) do drop(fraggedBot(A,location(X,Y,Z))).
	forall a-goal(fraggedBot(A,location(X,Y,Z))), bel(not(enemyBot(A,_))) do drop(fraggedBot(A,location(X,Y,Z))).

	% if you see an opponent bot then adopt to kill that bot.
	 forall bel(enemyBot(UnrealID,location(X,Y,Z))) do adopt(fraggedBot(UnrealID,location(X,Y,Z))).

	
}